extends includes/layout.pug

block content
  -
    const prev = page.prev
    const next = page.next
    const dateConf = theme.post.date
    const updatedConf = theme.post.updated
    const sourceConf = theme.post.source
    const excerptConf = theme.post.excerpt
    const reward = theme.post.reward
    const appID = theme.valine.app_id
    const appKey = theme.valine.app_key
    const encrypted = page.encrypt || page.password
    const tocContent = encrypted === undefined ? toc(page.content, theme.toc) : toc(page.origin, theme.toc)
  #post-bg
    #post-title
      h1= page.title
      if (dateConf || updatedConf) && page.published
        #post-info
          if sourceConf
            a(herf=page.source) View Source File
          if sourceConf && dateConf
            br
          if dateConf
            span First Post:
              div(style="display:inline-block;width:90px")
                time(datetime=page.date.toJSON())#date
                  = ' ' + date(page.date, date_format)
          if (sourceConf || dateConf) && updatedConf
            br
          if updatedConf
            span Last Update:
              div(style="display:inline-block;width:90px")
                time(datetime=page.updated.toJSON())#updated
                  = ' ' + date(page.updated, date_format)
    hr
    #post-content
      if excerptConf
        != page.content
      else
        != page.more
      #paginator!= paginator()
    #post-footer
      if prev || next
        #pages
          if prev !== undefined
            #footer-link(style="right: calc(50% - 1px);order: 1;border-right: 1px solid #fe2;padding-left: unset;max-width: calc(50% - 4px);")
              a(href=url_for(prev.path))
                |← Next
                =' ' + prev.title
          if next !== undefined
            #footer-link(style="left: 50%;order: 0;border-left: 1px solid #fe2;padding-right: unset;max-width: calc(50% - 5px);")
              a(href=url_for(next.path))
                =next.title + ' '
                |Prev →
    if reward === true
      details#reward
        summary 打赏
        #alipay
          span 支付宝 | Alipay
          br
          img(src= config.root + 'img/Alipay.png')
        #wechat
          span 微信 | WeChat
          br
          img(src= config.root + 'img/WeChat.png')
    if page.comments
      if theme.valine.enable === true
        #Valine
        script
          |new Valine({
          |  el: '#Valine'
          |  , appId: '#{appID}'
          |  , appKey: '#{appKey}'
          if theme.valine.server_url
            |  , serverURLs: '#{theme.valine.server_url}'
          |  , placeholder: '此条评论委托企鹅物流发送'
          |})
      if theme.gitalk.enable === true
        #comments
        - gitAdmin = ''
        for str in theme.gitalk.admin
          - gitAdmin= gitAdmin + "'" + str + "'"
        script
          |var gitalk = new Gitalk({
          |  clientID: '#{theme.gitalk.client_id}',
          |  clientSecret: '#{theme.gitalk.client_secret}',
          |  repo: '#{theme.gitalk.repo}',
          |  owner: '#{theme.gitalk.owner}',
          |  admin: [#{gitAdmin}],
          |  id: location.pathname,
          |})
          |gitalk.render("comments")

block aside-block
  - 
    const encrypted = page.encrypt || page.password
    const tocContent = encrypted === undefined ? toc(page.content, theme.toc) : toc(page.origin, theme.toc)
  if (tocContent.length > 0)
    h1 INDEX
    if (encrypted !== undefined)
      #toc-div(style="display:none")!= tocContent
    else
      #toc-div!= tocContent
