-
  let pageTitle = page.title || config.subtitle || ''
  if (is_post()) pageTitle = page.title
  if (is_archive()) pageTitle = 'Archives'
  if (is_tag()) pageTitle = 'Tag: ' + page.tag
  if (is_category()) pageTitle = 'Category: ' + page.category
  if (is_month()) pageTitle += ': ' + page.month + '/' + page.year
  if (is_year()) pageTitle += ': ' + page.year
  pageTitle += ' | ' + config.title
  const asideLogo = theme.aside.logo
  const asideBlock = theme.aside.block_in_top ? 'order: -1' : ''
  let onload = ''
  if (theme.pjax.enable) onload = "var pjax = new Pjax({selectors:['title','article','#aside-block','.pjax-js']});"
  let needReset = "code.findCode();"
  if (theme.mermaid.enable === true && theme.mermaid.version !== undefined) {
    onload += "mermaid.init(undefined, ('.mermaid'));";
    needReset += "mermaid.init(undefined, ('.mermaid'));";
  }
  let searchConfig = null
  if (theme.search !== undefined && theme.search.enable === true) searchConfig = theme.search;
  if (config.search !== undefined && config.search.enable === true) searchConfig = config.search;
  const configs = searchConfig !== null ? JSON.stringify({
    hostname: config.url,
    root    : config.root,
    preload : searchConfig.preload !== undefined ? searchConfig.preload : false,
    path    : searchConfig.path !== undefined ? searchConfig.path : '',
    }) : null

  var mainClass = theme.aside.in_left !== undefined &&theme.aside.in_left ? "left" : "right"
doctype html
html(lang=config.language)
  head
    meta(charset='UTF-8')
    meta(name='viewport' content='width=device-width, initial-scale=1.0')
    title= pageTitle
    if theme.valine.enable === true
      script(src='//unpkg.com/valine/dist/Valine.min.js')
    script var config = !{configs}
    if theme.gitalk.enable === true
      link(rel="stylesheet" href=config.root + "css/gitalk.css")
      script(src=config.root + "js/gitalk.js")
    if theme.mermaid.enable === true && theme.mermaid.version !== undefined
      script(src= "https://unpkg.com/mermaid@" + theme.mermaid.version + "/dist/mermaid.min.js")
      script
        | mermaid.initialize({
        |   startOnLoad: false
        |   , theme: 'dark'
        | });
    if theme.pjax.enable
      script(class="pjax-js") !{needReset}
    script window.onload = ()=>{!{onload}};
    link(rel="stylesheet", href=config.root + "css/arknights.css")
    if theme.stylesheets !== undefined && theme.stylesheets.length > 0
      //- stylesheets list from _config.yml
      each url in theme.stylesheets
        link(rel='stylesheet', href=url)
    style
      |@font-face {
      |  font-family: BenderLight;
      |  src: local('Bender'), url("#{config.root}font/BenderLight.ttf");
      |}
      |@font-face {
      |  font-family: 'JetBrains Mono';
      |  src: local('JetBrains Mono'), url('#{config.root}font/JetBrainsMono-Regular.woff2') format('woff2');
      |}
  body(style={'background-image': `url(${theme.background_image})`})
    #cursor-container
      #cursor-outer
      #cursor-effect
    header
      nav
        each url, label in theme.menu
          a(href= config.root + url)= label
      if configs !== null
        .search-header
          input(autocomplete="off" autocorrect="off" autocapitalize="none"
               placeholder="数据检索" spellcheck="false" maxlength="50"
               type="text" id="search-input")
    if configs !== null
      .search-pop-overlay(style="max-height: 0;")
        .popup
          #search-result
    main
      article
        if body
          div!= body
        else
          block content
        if page.published !== undefined
          #bottom-btn
            if tocLength > 0
              a#to-index(href="#toc-div" title="index") ≡
            a#to-top(onClick="index.scrolltop();" title="to top") ∧
      div.aside-box
        aside
          #aside-top
            #about
              a(href=config.root)#logo
                img(src=asideLogo, alt="Logo")
              h1#Dr
                a(href= theme.aside.dr)= config.author
              #description
                p= config.description
              //if page.published === undefined
              section#total
                 a#total-archives(href= config.root + "archives")
                   span.total-title Archives Total:
                   span.total-number= site.posts.length
                 #total-tags
                   span.total-title Tags:
                   span.total-number= site.tags.length
                 #total-categories
                   span.total-title Categories:
                   span.total-number= site.categories.length
            #aside-block(style= asideBlock)
              block aside-block
          footer(style=footerStyle)
            if theme.aside.copyright !== null
              each content, title in theme.aside.copyright
                nobr
                  span.text-title= title
                  span.text-content= content
                br
            text="published with "
              a(href='http://hexo.io') Hexo
            text=" Theme "
              a(href='https://github.com/Yue-plus/hexo-theme-arknights') Arknight
            wbr
            text="by "
              a(href='https://github.com/Yue-plus') Yue_plus
      if theme.canvas_dust
        canvas#canvas-dust
      script(src=config.root + "js/arknights.js")
      if theme.scripts !== undefined && theme.scripts.length > 0
        //- scripts list from config.yml
        each url in theme.scripts
          script(src=url)
      if searchConfig !== null
        script(src="/js/search.js")
      if theme.pjax.enable !== undefined && theme.pjax.enable === true
        script(src="//cdn.jsdelivr.net/npm/pjax@" + theme.pjax.version + "/pjax.min.js")
